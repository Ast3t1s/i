<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/test">
  <process id="_doc_dmr_10677" name="Дніпровська міська рада - Звернення громадян (вхідний шаблон)" isExecutable="true">
    <startEvent id="startevent1" name="Start">
      <extensionElements>
        <activiti:formProperty id="sTypeDoc" name="Тип документа" type="string" default="Звернення громадян"></activiti:formProperty>
        <activiti:formProperty id="sID_Custom_GovPublic" name="Номер звернення" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="processInstanceId" name="ID процесса" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="processDefinitionId" name="processDefinitionId" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sKey_Step_Document" name="sKey_Step_Document" type="invisible"></activiti:formProperty>
      </extensionElements>
    </startEvent>
    <serviceTask id="servicetask1" name="ProcessCountTask" activiti:delegateExpression="#{ProcessCountTaskListener}"></serviceTask>
    <scriptTask id="scripttask1" name="Script Task" scriptFormat="javascript" activiti:autoStoreVariables="false">
      <script>//1. счетчик добавления номера в поле входящего номера
var number=execution.getVariable('sID_Order_GovPublic')
var fullNumber="вх-"+number+"/"
execution.setVariable('sID_Order_GovPublic', fullNumber)

//2. назначение даты исполнения - по умолчанию + 30 дней к текущей даты и перевод даты в нужный формат дд/мм/гггг
var updatedDate = new Date();
var days = 30;
updatedDate.setDate(new Date().getDate() + days);
var d = updatedDate.getDate();
if (d &lt; 10) d = "0"+d;
var m = updatedDate.getMonth() + 1;
if (m &lt; 10) m = "0"+m;
var sNewDate = (d + "/" + m + "/" + updatedDate.getFullYear());
execution.setVariable('sDateExecution', sNewDate)

//3. получение ИД текущего процесса
var processInstanceId = execution.getProcessInstanceId();
execution.setVariable('processInstanceId', processInstanceId)

//4. получение ИД БП
var executeProcessDefinitionId = execution.getProcessDefinitionId();
var splittedProcessDefinitionId = executeProcessDefinitionId.split(':')[0];
execution.setVariable('processDefinitionId', splittedProcessDefinitionId)</script>
    </scriptTask>
    <sequenceFlow id="flow2" sourceRef="servicetask1" targetRef="scripttask1"></sequenceFlow>
    <userTask id="usertask1" name="Оператор КЦ" activiti:candidateGroups="dmr_operatorFO">
      <extensionElements>
        <activiti:formProperty id="processDefinitionId" name="processDefinitionId" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sTypeDoc" name="Тип документа" type="string" default="Звернення громадян" writable="false"></activiti:formProperty>
        <activiti:formProperty id="processInstanceId" name="ІД процесу" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="processDefinitionId" name="processDefinitionId" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sKey_Step_Document" name="sKey_Step_Document" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Group_Activiti" name="id группы" type="invisible" default="DMR_Head_"></activiti:formProperty>
        <activiti:formProperty id="nDeepLevel" name="глубина" type="invisible" default="2"></activiti:formProperty>
        <activiti:formProperty id="sName_SubjectRole" name="Логін" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sReportCommon" name="Текст звіту про виконання" type="invisible" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sSigned" name="Підписав" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sExecutor" name="Виконавець" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Custom_GovPublic" name="Вхідний номер" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="sDateRegistration" name="Дата реєстрації" type="date" required="true"></activiti:formProperty>
        <activiti:formProperty id="sDateDoc" name="Дата документа" type="date"></activiti:formProperty>
        <activiti:formProperty id="sNumberRegistration" name="Реєстраційний номер документа" type="string"></activiti:formProperty>
        <activiti:formProperty id="sApplicant" name="Кореспондент" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="sReason" name="Суть звернення" type="textArea" required="true"></activiti:formProperty>
        <activiti:formProperty id="sNote" name="Примітка" type="string"></activiti:formProperty>
        <activiti:formProperty id="asUrgently" name="терміновий документ; ;sID_CheckboxTrue=sEnumUrgentDoc" type="enum" default="sEnumNotUrgentDoc">
          <activiti:value id="sEnumUrgentDoc" name="терміновий"></activiti:value>
          <activiti:value id="sEnumNotUrgentDoc" name="не терміновий"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sDoc1" name="Електронна форма документа; ;bNew=true" type="file"></activiti:formProperty>
        <activiti:formProperty id="sAutorResolution" name="Автор резолюції; ;sID_SubjectRole=Executor,sID_Group_Activiti=sID_Group_Activiti,nDeepLevel=nDeepLevel" type="select"></activiti:formProperty>
        <activiti:formProperty id="sDateExecution" name="Термін виконання" type="date"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/minust/_doc_justice_171_rkk1.html]" type="invisible" default="РКК1" writable="false"></activiti:formProperty>
        <activiti:taskListener event="create" delegateExpression="${DocumentInit_iDoc}"></activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow3" sourceRef="scripttask1" targetRef="exclusivegateway1"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway1" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow4" sourceRef="startevent1" targetRef="servicetask1"></sequenceFlow>
    <sequenceFlow id="flow5" sourceRef="exclusivegateway1" targetRef="usertask1"></sequenceFlow>
    <sequenceFlow id="flow6" sourceRef="usertask1" targetRef="usertask2"></sequenceFlow>
    <userTask id="usertask2" name="Супервайзер - вибор оператора БО" activiti:candidateGroups="dmr_supervisor">
      <extensionElements>
        <activiti:formProperty id="processDefinitionId" name="processDefinitionId" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sTypeDoc" name="Тип документа" type="string" default="Звернення громадян" writable="false"></activiti:formProperty>
        <activiti:formProperty id="processInstanceId" name="ІД процесу" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="processDefinitionId" name="processDefinitionId" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sKey_Step_Document" name="sKey_Step_Document" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Group_Activiti" name="id группы" type="invisible" default="DMR_Head_"></activiti:formProperty>
        <activiti:formProperty id="nDeepLevel" name="глубина" type="invisible" default="2"></activiti:formProperty>
        <activiti:formProperty id="sName_SubjectRole" name="Логін" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sReportCommon" name="Текст звіту про виконання" type="invisible" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sSigned" name="Підписав" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sExecutor" name="Виконавець" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Custom_GovPublic" name="Вхідний номер" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="sDateRegistration" name="Дата реєстрації" type="date" required="true"></activiti:formProperty>
        <activiti:formProperty id="sDateDoc" name="Дата документа" type="date"></activiti:formProperty>
        <activiti:formProperty id="sNumberRegistration" name="Реєстраційний номер документа" type="string"></activiti:formProperty>
        <activiti:formProperty id="sApplicant" name="Кореспондент" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="sReason" name="Суть звернення" type="textArea" required="true"></activiti:formProperty>
        <activiti:formProperty id="sNote" name="Примітка" type="string"></activiti:formProperty>
        <activiti:formProperty id="asUrgently" name="терміновий документ; ;sID_CheckboxTrue=sEnumUrgentDoc" type="enum" default="sEnumNotUrgentDoc">
          <activiti:value id="sEnumUrgentDoc" name="терміновий"></activiti:value>
          <activiti:value id="sEnumNotUrgentDoc" name="не терміновий"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="asStatusSuper" name="Обрати спеціаліста" type="enum" required="true">
          <activiti:value id="sOperator_1" name="Оператор 1"></activiti:value>
          <activiti:value id="sOperator_2" name="Оператор 2"></activiti:value>
          <activiti:value id="sOperator_3" name="Оператор 3"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sDoc1" name="Електронна форма документа; ;bNew=true" type="file"></activiti:formProperty>
        <activiti:formProperty id="sAutorResolution" name="Автор резолюції; ;sID_SubjectRole=Executor,sID_Group_Activiti=sID_Group_Activiti,nDeepLevel=nDeepLevel" type="select"></activiti:formProperty>
        <activiti:formProperty id="sDateExecution" name="Термін виконання" type="date"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/minust/_doc_justice_171_rkk1.html]" type="invisible" default="РКК1" writable="false"></activiti:formProperty>
        <activiti:taskListener event="create" delegateExpression="${DocumentInit_iDoc}"></activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow8" sourceRef="exclusivegateway1" targetRef="usertask2"></sequenceFlow>
    <scriptTask id="scripttask2" name="отримання основного виконавця" scriptFormat="javascript" activiti:autoStoreVariables="false">
      <script>var processInstanceId = execution.getVariable('processInstanceId');
var obj = processSubjectTreeService.getCatalogProcessSubjectTree(processInstanceId, 1, null, false, 1);
var sMainExecutor = " ";
var sFirstName = " ";
var sLastName = " ";

var i = 0;
do {
i++
} while (obj.aProcessSubjectTree[0].sLogin != obj.aProcessSubjectTree[0].aUser[i].sLogin)
execution.setVariable('sMainExecutor', obj.aProcessSubjectTree[0].aUser[i].sLogin)
execution.setVariable('sFirstName', obj.aProcessSubjectTree[0].aUser[i].sFirstName)
execution.setVariable('sLastName', obj.aProcessSubjectTree[0].aUser[i].sLastName)
var sExecutor = obj.aProcessSubjectTree[0].aUser[i].sFirstName + " " + obj.aProcessSubjectTree[0].aUser[i].sLastName
execution.setVariable('sExecutor', sExecutor)</script>
    </scriptTask>
    <userTask id="usertask3" name="Оператор БО - відпрацювання звернення. Переадресація в управління" activiti:candidateGroups="dmr_${asStatusSuper}">
      <extensionElements>
        <activiti:formProperty id="processDefinitionId" name="processDefinitionId" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sTypeDoc" name="Тип документа" type="string" default="Звернення громадян" writable="false"></activiti:formProperty>
        <activiti:formProperty id="processInstanceId" name="ІД процесу" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="processDefinitionId" name="processDefinitionId" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sKey_Step_Document" name="sKey_Step_Document" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Group_Activiti" name="id группы" type="invisible" default="DMR_Head_"></activiti:formProperty>
        <activiti:formProperty id="nDeepLevel" name="глубина" type="invisible" default="2"></activiti:formProperty>
        <activiti:formProperty id="sName_SubjectRole" name="Логін" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sReportCommon" name="Текст звіту про виконання" type="invisible" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sSigned" name="Підписав" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sExecutor" name="Виконавець" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Custom_GovPublic" name="Вхідний номер" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="sDateRegistration" name="Дата реєстрації" type="date" required="true"></activiti:formProperty>
        <activiti:formProperty id="sDateDoc" name="Дата документа" type="date"></activiti:formProperty>
        <activiti:formProperty id="sNumberRegistration" name="Реєстраційний номер документа" type="string"></activiti:formProperty>
        <activiti:formProperty id="sApplicant" name="Кореспондент" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="sReason" name="Суть звернення" type="textArea" required="true"></activiti:formProperty>
        <activiti:formProperty id="sNote" name="Примітка" type="string"></activiti:formProperty>
        <activiti:formProperty id="asUrgently" name="терміновий документ; ;sID_CheckboxTrue=sEnumUrgentDoc" type="enum" default="sEnumNotUrgentDoc">
          <activiti:value id="sEnumUrgentDoc" name="терміновий"></activiti:value>
          <activiti:value id="sEnumNotUrgentDoc" name="не терміновий"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sDoc1" name="Електронна форма документа; ;bNew=true" type="file"></activiti:formProperty>
        <activiti:formProperty id="sAutorResolution" name="Автор резолюції; ;sID_SubjectRole=Executor,sID_Group_Activiti=sID_Group_Activiti,nDeepLevel=nDeepLevel" type="select"></activiti:formProperty>
        <activiti:formProperty id="sDateExecution" name="Термін виконання" type="date"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/minust/_doc_justice_171_rkk1.html]" type="invisible" default="РКК1" writable="false"></activiti:formProperty>
        <activiti:taskListener event="create" delegateExpression="${DocumentInit_iDoc}"></activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow11" sourceRef="usertask2" targetRef="usertask3"></sequenceFlow>
    <sequenceFlow id="flow12" sourceRef="usertask3" targetRef="usertask4"></sequenceFlow>
    <userTask id="usertask4" name="Керівник управління (департаменту)" activiti:candidateGroups="${sName_SubjectRole}">
      <extensionElements>
        <activiti:formProperty id="processInstanceId" name="ІД процесу" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="processDefinitionId" name="processDefinitionId" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sKey_Step_Document" name="sKey_Step_Document" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Group_Activiti" name="id группы" type="invisible" variable="sName_SubjectRole"></activiti:formProperty>
        <activiti:formProperty id="nDeepLevel" name="глубина" type="invisible" default="2"></activiti:formProperty>
        <activiti:formProperty id="sName_SubjectRole" name="Логін" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sReportCommon" name="Текст звіту про виконання" type="invisible" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sSigned" name="Підписав" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sExecutor" name="Виконавець" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sAutorResolution" name="Автор резолюції" type="select" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sTypeDoc" name="Тип документа" type="string" default="Звернення громадян" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sID_Custom_GovPublic" name="Вхідний номер" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sDateRegistration" name="Дата реєстрації" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sDateDoc" name="Дата документа" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sNumberRegistration" name="Реєстраційний номер документа" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sApplicant" name="Кореспондент" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="nCountAttach" name="Кількість додатків" type="long" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sContent" name="Короткий зміст документа" type="textArea" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sNote" name="Примітка" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="asUrgently" name="терміновий документ; ;sID_CheckboxTrue=sEnumUrgentDoc" type="enum" writable="false">
          <activiti:value id="sEnumUrgentDoc" name="терміновий"></activiti:value>
          <activiti:value id="sEnumNotUrgentDoc" name="не терміновий"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sTable2" name="Оберіть виконавця; ;bNew=true" type="table" default="${markerService.loadFromFile('table/sed/sTable2_doc_justice_171.json')}"></activiti:formProperty>
        <activiti:formProperty id="asTypeResolution" name="Резолюція" type="enum" required="true">
          <activiti:value id="sEnumNothing" name=" "></activiti:value>
          <activiti:value id="sEnumToReview" name="До розгляду"></activiti:value>
          <activiti:value id="sEnumPleaseReport" name="Прошу доповісти"></activiti:value>
          <activiti:value id="sEnumAccordingTolaw" name="Згідно з законодавством"></activiti:value>
          <activiti:value id="sEnumToAttention" name="До відома"></activiti:value>
          <activiti:value id="sEnumToPerform" name="До виконання"></activiti:value>
          <activiti:value id="sEnumToBusiness" name="До справи"></activiti:value>
          <activiti:value id="sEnumOtherResolution" name="Індивідуальна резолюція"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="markers3" name="Якщо Індивідуальна резолюція" type="markers" default="{&quot;motion&quot;:{&quot;ShowFieldsOnCondition_3&quot;:{&quot;aField_ID&quot;:[&quot;sTextResolution&quot;],&quot;asID_Field&quot;:{&quot;sClient&quot;:&quot;asTypeResolution&quot;},&quot;sCondition&quot;:&quot;[sClient] == 'sEnumOtherResolution'&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="sTextResolution" name="Текст резолюції" type="textArea"></activiti:formProperty>
        <activiti:formProperty id="sDateExecution" name="Термін виконання" type="date" required="true"></activiti:formProperty>
        <activiti:formProperty id="sDoc1" name="Електронна форма документа; ;bNew=true" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="cloneDocumentStepSubject" name="cloneDocumentStepSubject" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/minust/_doc_justice_171_rkk1.html]" type="invisible" default="РКК1" writable="false"></activiti:formProperty>
        <activiti:taskListener event="create" delegateExpression="${DocumentInit_iDoc}"></activiti:taskListener>
        <activiti:taskListener event="complete" delegateExpression="${SetTasks}">
          <activiti:field name="sTaskProcessDefinition">
            <activiti:string><![CDATA[system_task]]></activiti:string>
          </activiti:field>
          <activiti:field name="sID_Attachment">
            <activiti:expression><![CDATA[${sTable2}]]></activiti:expression>
          </activiti:field>
          <activiti:field name="processDefinitionId">
            <activiti:expression><![CDATA[${processDefinitionId}]]></activiti:expression>
          </activiti:field>
          <activiti:field name="soData">
            <activiti:expression><![CDATA[sDoc1::${sDoc1};;sDateRegistration::${sDateRegistration};;sDateDoc::${sDateDoc};;sName_SubjectRole::${sName_SubjectRole};;sDateExecution::${sDateExecution};;sContent::${sContent};;sAutorResolution::${sAutorResolution};;sTypeDoc::${sTypeDoc};;sID_Custom_GovPublic::${sID_Custom_GovPublic};;sApplicant::${sApplicant};;nCountAttach::${nCountAttach};;sNote::${sNote};;asUrgently::${asUrgently};;asTypeResolution::${asTypeResolution};;sTextResolution::${sTextResolution}]]></activiti:expression>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow13" sourceRef="usertask4" targetRef="scripttask2"></sequenceFlow>
    <userTask id="usertask5" name="Виконавець - формування відповіді на звернення" activiti:candidateGroups="${sMainExecutor}">
      <extensionElements>
        <activiti:formProperty id="processInstanceId" name="ІД процесу" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sKey_Step_Document" name="sKey_Step_Document" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Group_Activiti" name="id группы" type="invisible" default="MJU_Dnipro_"></activiti:formProperty>
        <activiti:formProperty id="nDeepLevel" name="глубина" type="invisible" default="5"></activiti:formProperty>
        <activiti:formProperty id="sName_SubjectRole" name="Логін" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sTypeDoc" name="Тип документа" type="string" default="Cлужбовий ініциативний лист" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sID_Custom_GovPublic" name="Вхідний номер" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sDateRegistration" name="Дата реєстрації" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sDateDoc" name="Дата документа" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sNumberRegistration" name="Реєстраційний номер документа" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sApplicant" name="Кореспондент" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="nCountAttach" name="Кількість додатків" type="long" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sContent" name="Короткий зміст документа" type="textArea" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sNote" name="Примітка" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="asUrgently" name="терміновий документ; ;sID_CheckboxTrue=sEnumUrgentDoc" type="enum" writable="false">
          <activiti:value id="sEnumUrgentDoc" name="терміновий"></activiti:value>
          <activiti:value id="sEnumNotUrgentDoc" name="не терміновий"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sDateExecution" name="Термін виконання" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sAutorResolution" name="Автор резолюції" type="select" writable="false"></activiti:formProperty>
        <activiti:formProperty id="asTypeResolution" name="Резолюція" type="enum" writable="false">
          <activiti:value id="sEnumNothing" name=" "></activiti:value>
          <activiti:value id="sEnumToReview" name="До розгляду"></activiti:value>
          <activiti:value id="sEnumPleaseReport" name="Прошу доповісти"></activiti:value>
          <activiti:value id="sEnumAccordingTolaw" name="Згідно з законодавством"></activiti:value>
          <activiti:value id="sEnumToAttention" name="До відома"></activiti:value>
          <activiti:value id="sEnumToPerform" name="До виконання"></activiti:value>
          <activiti:value id="sEnumToBusiness" name="До справи"></activiti:value>
          <activiti:value id="sEnumOtherResolution" name="Індивідуальна резолюція"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sTextResolution" name="Текст резолюції" type="textArea" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sReportCommon" name="Текст звіту про виконання" type="textArea"></activiti:formProperty>
        <activiti:formProperty id="sDoc1" name="Електронна форма документа; ;bNew=true" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="asTypeDispatch" name="Вид відправки документа" type="enum" required="true">
          <activiti:value id="sEnum1" name="поштовий зв'язок"></activiti:value>
          <activiti:value id="sEnum2" name="нарочно"></activiti:value>
          <activiti:value id="sEnum3" name="самостійно"></activiti:value>
          <activiti:value id="sEnum4" name="електронною поштою та поштою"></activiti:value>
          <activiti:value id="sEnum5" name="електронною поштою"></activiti:value>
          <activiti:value id="sEnum6" name="замовленою кореспонденцією"></activiti:value>
          <activiti:value id="sEnum7" name="рекомендованим листом з повідомленням"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="asDecisionNoText" name="Коментарій основному виконавцю - що саме треба доробити" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sMainExecutor" name="Основний виконавець логін" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sExecutor" name="Виконавець" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/minust/_doc_justice_171_rkk1.html]" type="invisible" default="РКК1" writable="false"></activiti:formProperty>
        <activiti:taskListener event="create" delegateExpression="${DocumentInit_iDoc}"></activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow14" sourceRef="scripttask2" targetRef="usertask5"></sequenceFlow>
    <userTask id="usertask6" name="Оператор БО - перевірка відповіді" activiti:candidateGroups="dmr_${asStatusSuper}">
      <extensionElements>
        <activiti:formProperty id="processInstanceId" name="ІД процесу" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sKey_Step_Document" name="sKey_Step_Document" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sID_Group_Activiti" name="id группы" type="invisible" default="MJU_Dnipro_"></activiti:formProperty>
        <activiti:formProperty id="nDeepLevel" name="глубина" type="invisible" default="5"></activiti:formProperty>
        <activiti:formProperty id="sName_SubjectRole" name="Логін" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sTypeDoc" name="Тип документа" type="string" default="Cлужбовий ініциативний лист" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sID_Custom_GovPublic" name="Вхідний номер" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sDateRegistration" name="Дата реєстрації" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sDateDoc" name="Дата документа" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sNumberRegistration" name="Реєстраційний номер документа" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sApplicant" name="Кореспондент" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="nCountAttach" name="Кількість додатків" type="long" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sContent" name="Короткий зміст документа" type="textArea" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sNote" name="Примітка" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="asUrgently" name="терміновий документ; ;sID_CheckboxTrue=sEnumUrgentDoc" type="enum" writable="false">
          <activiti:value id="sEnumUrgentDoc" name="терміновий"></activiti:value>
          <activiti:value id="sEnumNotUrgentDoc" name="не терміновий"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sDateExecution" name="Термін виконання" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sAutorResolution" name="Автор резолюції" type="select" writable="false"></activiti:formProperty>
        <activiti:formProperty id="asTypeResolution" name="Резолюція" type="enum" writable="false">
          <activiti:value id="sEnumNothing" name=" "></activiti:value>
          <activiti:value id="sEnumToReview" name="До розгляду"></activiti:value>
          <activiti:value id="sEnumPleaseReport" name="Прошу доповісти"></activiti:value>
          <activiti:value id="sEnumAccordingTolaw" name="Згідно з законодавством"></activiti:value>
          <activiti:value id="sEnumToAttention" name="До відома"></activiti:value>
          <activiti:value id="sEnumToPerform" name="До виконання"></activiti:value>
          <activiti:value id="sEnumToBusiness" name="До справи"></activiti:value>
          <activiti:value id="sEnumOtherResolution" name="Індивідуальна резолюція"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sTextResolution" name="Текст резолюції" type="textArea" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sReportCommon" name="Текст звіту про виконання" type="textArea" writable="false"></activiti:formProperty>
        <activiti:formProperty id="asTypeDispatch" name="Вид відправки документа" type="enum" writable="false">
          <activiti:value id="sEnum1" name="поштовий зв'язок"></activiti:value>
          <activiti:value id="sEnum2" name="нарочно"></activiti:value>
          <activiti:value id="sEnum3" name="самостійно"></activiti:value>
          <activiti:value id="sEnum4" name="електронною поштою та поштою"></activiti:value>
          <activiti:value id="sEnum5" name="електронною поштою"></activiti:value>
          <activiti:value id="sEnum6" name="замовленою кореспонденцією"></activiti:value>
          <activiti:value id="sEnum7" name="рекомендованим листом з повідомленням"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sDoc1" name="Електронна форма документа; ;bNew=true" type="file" writable="false"></activiti:formProperty>
        <activiti:formProperty id="asDecision" name="Прийняття рішення про виконання завдання" type="enum" required="true">
          <activiti:value id="sEnumDecisionYes" name="Завдання виконано - сформувати вихідний документ"></activiti:value>
          <activiti:value id="sEnumDecisionNo" name="Повернути документ на доопрацювання"></activiti:value>
          <activiti:value id="sEnumDecisionYesBut" name="Завдання виконано - Не формувати вихідний документ"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sMainExecutor" name="Основний виконавець" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sExecutor" name="Виконавець" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="markers5" name="Якщо доопрацювання" type="markers" default="{&quot;motion&quot;:{&quot;ShowFieldsOnCondition_5&quot;:{&quot;aField_ID&quot;:[&quot;asDecisionNoText&quot;],&quot;asID_Field&quot;:{&quot;sClient&quot;:&quot;asDecision&quot;},&quot;sCondition&quot;:&quot;[sClient] == 'sEnumDecisionNo'&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="asDecisionNoText" name="Коментарій основному виконавцю - що саме треба доробити" type="string"></activiti:formProperty>
        <activiti:formProperty id="sIncomingNumber" name="sIncomingNumber" type="invisible"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/minust/_doc_justice_171_rkk1.html]" type="invisible" default="РКК1" writable="false"></activiti:formProperty>
        <activiti:taskListener event="create" delegateExpression="${DocumentInit_iDoc}"></activiti:taskListener>
        <activiti:taskListener event="complete" delegateExpression="${UpdateStatusTaskTreeAndCloseProcess}">
          <activiti:field name="snID_Process_Activiti">
            <activiti:expression><![CDATA[${processInstanceId}]]></activiti:expression>
          </activiti:field>
          <activiti:field name="sID_ProcessSubjectStatus">
            <activiti:string><![CDATA[unactual]]></activiti:string>
          </activiti:field>
        </activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow15" sourceRef="usertask5" targetRef="usertask6"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway3" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow16" sourceRef="usertask6" targetRef="exclusivegateway3"></sequenceFlow>
    <scriptTask id="scripttask3" name="перетворення вхідного номера для передачі в вихідний шаблон" scriptFormat="javascript" activiti:autoStoreVariables="false">
      <script>//1. преобразование входящего номера для передачи в исходящий шаблон
var number=execution.getVariable('sID_Custom_GovPublic')
execution.setVariable('sIncomingNumber',sID_Custom_GovPublic)</script>
    </scriptTask>
    <sequenceFlow id="flow17" sourceRef="exclusivegateway3" targetRef="scripttask3">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${asDecision =='sEnumDecisionYes'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow18" sourceRef="exclusivegateway3" targetRef="usertask5">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${asDecision =='sEnumDecisionNo'}]]></conditionExpression>
    </sequenceFlow>
    <endEvent id="endevent1" name="End"></endEvent>
    <sequenceFlow id="flow19" sourceRef="scripttask3" targetRef="callactivity1"></sequenceFlow>
    <callActivity id="callactivity1" name="Виклик шаблону _doc_dmr_11401" calledElement="_doc_dmr_11401">
      <extensionElements>
        <activiti:in source="sIncomingNumber" target="sIncomingNumber"></activiti:in>
        <activiti:in source="sApplicant" target="sApplicant"></activiti:in>
        <activiti:in source="sReportCommon" target="sReportCommon"></activiti:in>
        <activiti:in source="sExecutor" target="sExecutor"></activiti:in>
        <activiti:in source="sAutorResolution" target="sAutorResolution"></activiti:in>
        <activiti:in source="asTypeDispatch" target="asTypeDispatch"></activiti:in>
        <activiti:in source="sDoc1" target="sDoc1"></activiti:in>
      </extensionElements>
    </callActivity>
    <sequenceFlow id="flow20" sourceRef="callactivity1" targetRef="endevent1"></sequenceFlow>
    <sequenceFlow id="flow21" sourceRef="exclusivegateway3" targetRef="endevent1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${asDecision =='sEnumDecisionYesBut'}]]></conditionExpression>
    </sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram__doc_dmr_10677">
    <bpmndi:BPMNPlane bpmnElement="_doc_dmr_10677" id="BPMNPlane__doc_dmr_10677">
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="80.0" y="150.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask1" id="BPMNShape_servicetask1">
        <omgdc:Bounds height="75.0" width="121.0" x="150.0" y="130.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask1" id="BPMNShape_scripttask1">
        <omgdc:Bounds height="75.0" width="121.0" x="300.0" y="130.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask1" id="BPMNShape_usertask1">
        <omgdc:Bounds height="75.0" width="115.0" x="433.0" y="230.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="470.0" y="147.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask2" id="BPMNShape_usertask2">
        <omgdc:Bounds height="75.0" width="116.0" x="555.0" y="130.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask2" id="BPMNShape_scripttask2">
        <omgdc:Bounds height="70.0" width="161.0" x="710.0" y="341.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask3" id="BPMNShape_usertask3">
        <omgdc:Bounds height="75.0" width="161.0" x="710.0" y="130.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask4" id="BPMNShape_usertask4">
        <omgdc:Bounds height="71.0" width="161.0" x="710.0" y="240.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask5" id="BPMNShape_usertask5">
        <omgdc:Bounds height="71.0" width="161.0" x="710.0" y="440.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask6" id="BPMNShape_usertask6">
        <omgdc:Bounds height="81.0" width="161.0" x="710.0" y="540.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway3" id="BPMNShape_exclusivegateway3">
        <omgdc:Bounds height="40.0" width="40.0" x="613.0" y="560.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask3" id="BPMNShape_scripttask3">
        <omgdc:Bounds height="81.0" width="142.0" x="440.0" y="540.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent1" id="BPMNShape_endevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="494.0" y="680.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="callactivity1" id="BPMNShape_callactivity1">
        <omgdc:Bounds height="81.0" width="105.0" x="272.0" y="540.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow2" id="BPMNEdge_flow2">
        <omgdi:waypoint x="271.0" y="167.0"></omgdi:waypoint>
        <omgdi:waypoint x="300.0" y="167.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow3" id="BPMNEdge_flow3">
        <omgdi:waypoint x="421.0" y="167.0"></omgdi:waypoint>
        <omgdi:waypoint x="470.0" y="167.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow4" id="BPMNEdge_flow4">
        <omgdi:waypoint x="115.0" y="167.0"></omgdi:waypoint>
        <omgdi:waypoint x="150.0" y="167.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow5" id="BPMNEdge_flow5">
        <omgdi:waypoint x="490.0" y="187.0"></omgdi:waypoint>
        <omgdi:waypoint x="490.0" y="230.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow6" id="BPMNEdge_flow6">
        <omgdi:waypoint x="548.0" y="267.0"></omgdi:waypoint>
        <omgdi:waypoint x="613.0" y="267.0"></omgdi:waypoint>
        <omgdi:waypoint x="613.0" y="205.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow8" id="BPMNEdge_flow8">
        <omgdi:waypoint x="510.0" y="167.0"></omgdi:waypoint>
        <omgdi:waypoint x="555.0" y="167.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow11" id="BPMNEdge_flow11">
        <omgdi:waypoint x="671.0" y="167.0"></omgdi:waypoint>
        <omgdi:waypoint x="710.0" y="167.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow12" id="BPMNEdge_flow12">
        <omgdi:waypoint x="790.0" y="205.0"></omgdi:waypoint>
        <omgdi:waypoint x="790.0" y="240.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
        <omgdi:waypoint x="790.0" y="311.0"></omgdi:waypoint>
        <omgdi:waypoint x="790.0" y="341.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow14" id="BPMNEdge_flow14">
        <omgdi:waypoint x="790.0" y="411.0"></omgdi:waypoint>
        <omgdi:waypoint x="790.0" y="440.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow15" id="BPMNEdge_flow15">
        <omgdi:waypoint x="790.0" y="511.0"></omgdi:waypoint>
        <omgdi:waypoint x="790.0" y="540.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow16" id="BPMNEdge_flow16">
        <omgdi:waypoint x="710.0" y="580.0"></omgdi:waypoint>
        <omgdi:waypoint x="653.0" y="580.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow17" id="BPMNEdge_flow17">
        <omgdi:waypoint x="613.0" y="580.0"></omgdi:waypoint>
        <omgdi:waypoint x="582.0" y="580.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow18" id="BPMNEdge_flow18">
        <omgdi:waypoint x="633.0" y="560.0"></omgdi:waypoint>
        <omgdi:waypoint x="633.0" y="475.0"></omgdi:waypoint>
        <omgdi:waypoint x="710.0" y="475.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow19" id="BPMNEdge_flow19">
        <omgdi:waypoint x="440.0" y="580.0"></omgdi:waypoint>
        <omgdi:waypoint x="377.0" y="580.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow20" id="BPMNEdge_flow20">
        <omgdi:waypoint x="324.0" y="621.0"></omgdi:waypoint>
        <omgdi:waypoint x="324.0" y="697.0"></omgdi:waypoint>
        <omgdi:waypoint x="494.0" y="697.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow21" id="BPMNEdge_flow21">
        <omgdi:waypoint x="633.0" y="600.0"></omgdi:waypoint>
        <omgdi:waypoint x="633.0" y="697.0"></omgdi:waypoint>
        <omgdi:waypoint x="529.0" y="697.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>